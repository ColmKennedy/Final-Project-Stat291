---
title: "Final Project - EDA"
author: "Shril Patel"
date: "2022-11-19"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Libraries

```{r}
library(ggplot2)
library(moderndive)
library(dplyr)

all <- read.csv('all.csv')

head(all)

```

# Exploratory Data Analysis


#Murder
```{r}

ggplot(data=all, aes(x=murder)) + geom_histogram(color = "white")

cor(all$lifeexp, all$murder)

ggplot(data=all, aes(x=murder, y=lifeexp)) + geom_point() + geom_smooth(method = 'lm', se = FALSE)
```

#Analysis: After observing the correlation coefficient between lifeexp and murder it was clear that the relationship between the two was very weak. As a result, when plotted on a scatterplot the projected line is almost a horizontal line. Although the murder variable does not have as big an impact on lifeexp, murder may be closely related to another variable to create a influential factor for lifeexp. Further analysis with its colinearity with other variables would be needed.


#GDPCapita
```{r}
ggplot(data=all, aes(x=gdpcapita)) + geom_histogram(color = "white")

cor(all$lifeexp, all$gdpcapita)

ggplot(data=all, aes(x=gdpcapita, y=lifeexp)) + geom_point() + geom_smooth(method = 'lm', se = FALSE)

model1 <- lm(data=all, lifeexp~gdpcapita)
get_regression_table(model1)
get_regression_summaries(model1)

all2 <- all %>% mutate(lifeexp=log(lifeexp), gdpcapita=log(gdpcapita))
model2 <- lm(data=all2, lifeexp~gdpcapita)
get_regression_table(model2)
get_regression_summaries(model2)


ggplot(data=all2, aes(x=gdpcapita, y=lifeexp)) + geom_point() + geom_smooth(method = 'lm', se = FALSE) 
```

#Analysis: After taking a look at the relatively hight correlation coefficient between gdpcapita and lifeexp, I saw that plotting a scatterplot with a regression line of lifeexp on gdpcapita showed that the pattern of points followed a exponential curve rather than a linear line. So after taking a look at the log of lifeexp on log of gdpcapita, the scatterplot shows that the points more closely follow the regression line. The relationship between gdpcapita and lifeexp is a positive one that shows that as gdpcapita increases, so does lifeexp.


#HealthSpend
```{r}
ggplot(data=all, aes(x=healthspend)) + geom_histogram(color = "white")

cor(all$lifeexp, all$healthspend)

ggplot(data=all, aes(x=healthspend, y=lifeexp)) + geom_point() + geom_smooth(method = 'lm', se = FALSE)

model3 <- lm(data=all, lifeexp~healthspend)
get_regression_table(model3)
get_regression_summaries(model3)

all3 <- all %>% mutate(lifeexp=log(lifeexp), healthspend=log(healthspend))
model4 <- lm(data=all3, lifeexp~healthspend)
get_regression_table(model4)
get_regression_summaries(model4)


ggplot(data=all3, aes(x=healthspend, y=lifeexp)) + geom_point() + geom_smooth(method = 'lm', se = FALSE) 
```

#Analysis: The correlation coefficient between lifeexp and healthspend is 0.592, which shows that there is a positive relationship between healthspend and lifeexp. Further examining this relationship, the scatterplot of the relationship shows a exponential curve of the data points. After applying the log() function to lifeexp and healthspend, we can see more clearly how the data points on the plot appear to be closer to the projected positive regression line. 



